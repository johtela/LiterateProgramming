

<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Weaver - Literate Programming</title>

	<link rel="icon" type="image/x-icon" href="../images/favicon.ico">
    <link rel="stylesheet" href="../bootstrap/css/readable/bootstrap.min.css" />
<link rel="stylesheet" href="../font-awesome/css/font-awesome.min.css">
<link rel="stylesheet" href="../sidebar/sidebar.min.css" />
<link rel="stylesheet" href="../css/book.min.css" />
<link rel="stylesheet" href="../syntax-highlight/solarized-light.min.css" />
<link rel="stylesheet" href="../mermaid/mermaid.css" />

</head>

<body>
    
    <nav class="navbar navbar-inverse">
        <div class="container-fluid">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="../index.html">Literate Programming</a>
            </div>
            <div id="navbar" class="navbar-collapse collapse">
                <ul class="nav navbar-nav">
                    <li><a href="../index.html"><i class="fa fa-home" aria-hidden="true"></i> Home</a></li>
					<li><a href="https://github.com/johtela/LiterateProgramming"><i class="fa fa-github" aria-hidden="true"></i> GitHub Repository</a></li>
                    <li><a href="https://github.com/johtela/LiterateProgramming/releases"><i class="fa fa-download" aria-hidden="true"></i> Download</a></li>
                    <li><a href="../License.html">License</a></li>
                </ul>
            </div>
        </div>
    </nav>

    <div class="container">
        <div class="row">
            <div class="col-md-3 hidden-xs hidden-sm">
                
        <div class="panel panel-default">
            <div class="panel-heading">
                <h4>On This Page</h4>
            </div>
            <div id="header-menu" class="panel-body main-menu">
                <ul></ul>
            </div>
        </div>  
        <div class="panel panel-default">
            <div class="panel-heading">
                <h4>Table of Contents</h4>
            </div>
            <div class="panel-body main-menu">
                <ul>
	<li><a href="../index.html">Home</a></li>
	<ul>
	</ul>
	<li><a href="../Introduction.html">Introduction</a></li>
	<ul>
	</ul>
	<li><a href="../src/Options.html">Command Line Options</a></li>
	<ul>
	</ul>
	<li><a href="../src/Program.html">Main Program</a></li>
	<ul>
	</ul>
	<li><a href="../src/SplitPath.html">SplitPath Structure</a></li>
	<ul>
	</ul>
	<li><a href="../src/Weaver.html" class="selected">Document Weaver</a></li>
	<ul>
	</ul>
	<li><a href="../src/MdWeaver.html">Markdown Weaver</a></li>
	<ul>
	</ul>
	<li><a href="../src/HtmlWeaver.html">HTML Weaver</a></li>
	<ul>
	</ul>
	<li><a href="../src/TocManager.html">TOC Manager</a></li>
	<ul>
	</ul>
	<li><a href="../src/MSBuildHelpers.html">MSBuild Helpers</a></li>
	<ul>
	</ul>
	<li><a href="../src/BlockList.html">Source Blocks</a></li>
	<ul>
	</ul>
	<li><a href="../src/Macro.html">Macros</a></li>
	<ul>
	</ul>
	<li><a href="../src/BlockBuilder.html">Block Builder</a></li>
	<ul>
	</ul>
	<li><a href="../src/HtmlBlockBuilder.html">HTML Block Builder</a></li>
	<ul>
	</ul>
	<li><a href="../src/HtmlGenerator.html">HTML Generation</a></li>
	<ul>
	</ul>
	<li>Themes</li>
	<ul>
<ul>
	<li><a href="../CSWeave.Theme/DirHelpers.html">Directory Utilities</a></li>
	<ul>
	</ul>
	<li><a href="../CSWeave.Theme/Toc.html">Table of Contents Classes</a></li>
	<ul>
	</ul>
	<li><a href="../CSWeave.Theme/PageParams.html">Page Parameters</a></li>
	<ul>
	</ul>
	<li><a href="../CSWeave.Theme/Theme.html">Theme Base Class</a></li>
	<ul>
	</ul>
</ul>
	</ul>
	<li><a href="../FrontMatter.html">Front Matter</a></li>
	<ul>
	</ul>
	<li><a href="../TableOfContents.html">Table of Contents File</a></li>
	<ul>
	</ul>
	<li><a href="../TipsAndTricks.html">Tips &amp; Tricks</a></li>
	<ul>
	</ul>
	<li><a href="../License.html">License</a></li>
	<ul>
	</ul>
	<li><a href="../README.html">README</a></li>
	<ul>
	</ul>
</ul>
            </div>
        </div>

            </div>
			<div class="col-md-9">
				<ul class="pager">
	<li class="previous"><a href="../src/SplitPath.html">Previous: SplitPath Structure</a></li>
	<li class="next"><a href="../src/MdWeaver.html">Next: Markdown Weaver</a></li>
</ul>
				<div id="static-content" class="markdown">
					<h1 id="document-weaver">Document Weaver</h1>
<p>The main workhorse of the application is the weaver. It enumerates the source
files as specified by command line options and generates documentation for each
file separately.</p>
<p>The Weaver class is abstract, and the actual documentation generation is
delegated to its subclasses. There are two subclasses for the two output
formats: <a href="MdWeaver.html">MdWeaver</a> for markdown and <a href="HtmlWeaver.html">HtmlWeaver</a>
for HTML.</p>
<p>Let's first look at the base class which contains code common to both weavers.</p>
<h2 id="dependencies">Dependencies</h2>
<p>We utilize a couple of libraries provided by Microsoft to access MSBuild
solution and project files. The first one resides in the <code>Microsoft.Build.*</code>
assemblies. They contain classes and methods for manipulating MS Build solution
files; to open a solution, enumerate the files in it, get the build
configurations, and so on.</p>
<p>The other important dependency is the <a href="https://github.com/dotnet/roslyn">Roslyn</a>
compiler platform. The assemblies related to that lay under the <code>Microsoft.CodeAnalysis.*</code>
namespace. Weaver needs to reference the namespaces to access their types, but
doesn't really use them. More involved code related to Roslyn and solution compilation
is separated to the helper class <a href="MSBuildHelpers.html">MSBuildHelpers</a>. Weaver tries
to keep things simple by working on the higher abstraction level.</p>
<pre class="csharp"><code class="csharp"><span class="keyword" id="LiterateProgramming">namespace</span> LiterateProgramming
<span class="punctuation">{</span>
	<span class="keyword">using</span> CSWeave<span class="punctuation">.</span>Theme<span class="punctuation">;</span>
	<span class="keyword">using</span> Microsoft<span class="punctuation">.</span>Build<span class="punctuation">.</span>Construction<span class="punctuation">;</span>
	<span class="keyword">using</span> Microsoft<span class="punctuation">.</span>CodeAnalysis<span class="punctuation">;</span>
	<span class="keyword">using</span> Microsoft<span class="punctuation">.</span>CodeAnalysis<span class="punctuation">.</span>MSBuild<span class="punctuation">;</span>
	<span class="keyword">using</span> System<span class="punctuation">;</span>
	<span class="keyword">using</span> System<span class="punctuation">.</span>Collections<span class="punctuation">.</span>Generic<span class="punctuation">;</span>
	<span class="keyword">using</span> System<span class="punctuation">.</span>IO<span class="punctuation">;</span>
	<span class="keyword">using</span> System<span class="punctuation">.</span>Linq<span class="punctuation">;</span>
	<span class="keyword">using</span> System<span class="punctuation">.</span>Text<span class="punctuation">.</span>RegularExpressions<span class="punctuation">;</span>

	<span class="keyword" id="LiterateProgramming.Weaver">public</span> <span class="keyword">abstract</span> <span class="keyword">class</span> <span class="typename">Weaver</span>
	<span class="punctuation">{</span>
</code></pre>
<h2 id="creating-a-weaver">Creating a Weaver</h2>
<p>When creating a weaver the selected command line options must be passed to it.</p>
<pre class="csharp"><code class="csharp">		<span class="keyword">protected</span> <span class="typename" data-toggle="tooltip" title="LiterateProgramming.Options"><a href="../src/Options.html#LiterateProgramming.Options">Options</a></span> <span id="LiterateProgramming.Weaver._options">_options</span><span class="punctuation">;</span>

		<span class="keyword" id="LiterateProgramming.Weaver.Weaver(LiterateProgramming.Options)" data-toggle="tooltip" title="LiterateProgramming.Weaver.Weaver(LiterateProgramming.Options)">public</span> <span data-toggle="tooltip" title="LiterateProgramming.Weaver.Weaver(LiterateProgramming.Options)">Weaver</span> <span class="punctuation">(</span><span class="typename" data-toggle="tooltip" title="LiterateProgramming.Options"><a href="../src/Options.html#LiterateProgramming.Options">Options</a></span> options<span class="punctuation">)</span>
		<span class="punctuation">{</span>
			<span data-toggle="tooltip" title="LiterateProgramming.Options"><a href="../src/Weaver.html#LiterateProgramming.Weaver._options">_options</a></span> <span class="punctuation" data-toggle="tooltip" title="LiterateProgramming.Options">=</span> <span data-toggle="tooltip" title="LiterateProgramming.Options">options</span><span class="punctuation">;</span>
		<span class="punctuation">}</span>
</code></pre>
<h2 id="generating-documentation">Generating Documentation</h2>
<p>Weaver can generate documentation from two sources: from a directory or from a
solution. One of the abstract methods below is invoked when the tool is run. Which
one is selected depends on the command line options.</p>
<pre class="csharp"><code class="csharp">		<span class="keyword" id="LiterateProgramming.Weaver.GenerateFromFiles()" data-toggle="tooltip" title="LiterateProgramming.Weaver.GenerateFromFiles()">protected</span> <span class="keyword" data-toggle="tooltip" title="LiterateProgramming.Weaver.GenerateFromFiles()">abstract</span> <span class="keyword" data-toggle="tooltip" title="void">void</span> <span data-toggle="tooltip" title="LiterateProgramming.Weaver.GenerateFromFiles()">GenerateFromFiles</span> <span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation" data-toggle="tooltip" title="LiterateProgramming.Weaver.GenerateFromFiles()">;</span>
		<span class="keyword" id="LiterateProgramming.Weaver.GenerateFromSolution()" data-toggle="tooltip" title="LiterateProgramming.Weaver.GenerateFromSolution()">protected</span> <span class="keyword" data-toggle="tooltip" title="LiterateProgramming.Weaver.GenerateFromSolution()">abstract</span> <span class="keyword" data-toggle="tooltip" title="void">void</span> <span data-toggle="tooltip" title="LiterateProgramming.Weaver.GenerateFromSolution()">GenerateFromSolution</span> <span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation" data-toggle="tooltip" title="LiterateProgramming.Weaver.GenerateFromSolution()">;</span>
</code></pre>
<p>Another method which the subclasses can override is the CreateBlockBuilder that is
defined	below. This	method will create the <a href="BlockBuilder.html">BlockBuilder</a> class
that is responsible for splitting the input files into blocks. The standard
implementation is sufficient for generating markdown output, but
<a href="HtmlWeaver.html">HtmlWeaver</a> requires more sophisticated functionality provided by
the <a href="HtmlBlockBuilder.html">HtmlBlockBuilder</a> class.</p>
<pre class="csharp"><code class="csharp">		<span class="keyword" id="LiterateProgramming.Weaver.CreateBlockBuilder()" data-toggle="tooltip" title="LiterateProgramming.Weaver.CreateBlockBuilder()">protected</span> <span class="keyword" data-toggle="tooltip" title="LiterateProgramming.Weaver.CreateBlockBuilder()">virtual</span> <span class="typename" data-toggle="tooltip" title="LiterateProgramming.BlockBuilder"><a href="../src/BlockBuilder.html#LiterateProgramming.BlockBuilder">BlockBuilder</a></span> <span data-toggle="tooltip" title="LiterateProgramming.Weaver.CreateBlockBuilder()">CreateBlockBuilder</span> <span class="punctuation">(</span><span class="punctuation">)</span>
		<span class="punctuation">{</span>
			<span class="keyword">return</span> <span class="keyword" data-toggle="tooltip" title="LiterateProgramming.BlockBuilder">new</span> <span class="typename"><a href="../src/BlockBuilder.html#LiterateProgramming.BlockBuilder">BlockBuilder</a></span> <span class="punctuation">(</span><span data-toggle="tooltip" title="LiterateProgramming.Options"><a href="../src/Weaver.html#LiterateProgramming.Weaver._options">_options</a></span><span class="punctuation">)</span><span class="punctuation">;</span>
		<span class="punctuation">}</span>
</code></pre>
<h3 id="main-execution-method">Main Execution Method</h3>
<p>Main program will call the method below to run the document generation. The method
determines whether the files are read from a solution or from an input folder. Based
on the options it will call the appropriate virtual method.</p>
<pre class="csharp"><code class="csharp">		<span class="keyword" id="LiterateProgramming.Weaver.GenerateDocumentation()" data-toggle="tooltip" title="LiterateProgramming.Weaver.GenerateDocumentation()">public</span> <span class="keyword" data-toggle="tooltip" title="void">void</span> <span data-toggle="tooltip" title="LiterateProgramming.Weaver.GenerateDocumentation()">GenerateDocumentation</span> <span class="punctuation">(</span><span class="punctuation">)</span>
		<span class="punctuation">{</span>
			<span class="keyword">if</span> <span class="punctuation">(</span><span data-toggle="tooltip" title="LiterateProgramming.Options"><a href="../src/Weaver.html#LiterateProgramming.Weaver._options">_options</a></span><span class="punctuation" data-toggle="tooltip" title="string">.</span><span data-toggle="tooltip" title="string"><a href="../src/Options.html#LiterateProgramming.Options.Solution">Solution</a></span> <span class="punctuation" data-toggle="tooltip" title="bool">!=</span> <span class="keyword">null</span><span class="punctuation">)</span>
			<span class="punctuation">{</span>
				<span data-toggle="tooltip" title="LiterateProgramming.Weaver.ConsoleOut(string, params object[])"><a href="../src/Weaver.html#LiterateProgramming.Weaver.ConsoleOut(string, object[])">ConsoleOut</a></span> <span class="punctuation">(</span><span class="string" data-toggle="tooltip" title="string">&quot;Creating documentation for solution: {0}&quot;</span><span class="punctuation">,</span> 
					<span data-toggle="tooltip" title="LiterateProgramming.Options"><a href="../src/Weaver.html#LiterateProgramming.Weaver._options">_options</a></span><span class="punctuation" data-toggle="tooltip" title="string">.</span><span data-toggle="tooltip" title="string"><a href="../src/Options.html#LiterateProgramming.Options.Solution">Solution</a></span><span class="punctuation">)</span><span class="punctuation">;</span>
				<span data-toggle="tooltip" title="LiterateProgramming.Weaver.GenerateFromSolution()"><a href="../src/Weaver.html#LiterateProgramming.Weaver.GenerateFromSolution()">GenerateFromSolution</a></span> <span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">;</span>
			<span class="punctuation">}</span>
			<span class="keyword">else</span>
			<span class="punctuation">{</span>
				<span data-toggle="tooltip" title="LiterateProgramming.Weaver.ConsoleOut(string, params object[])"><a href="../src/Weaver.html#LiterateProgramming.Weaver.ConsoleOut(string, object[])">ConsoleOut</a></span> <span class="punctuation">(</span><span class="string" data-toggle="tooltip" title="string">&quot;Creating documentation for files in directory: {0}&quot;</span><span class="punctuation">,</span> 
					<span data-toggle="tooltip" title="LiterateProgramming.Options"><a href="../src/Weaver.html#LiterateProgramming.Weaver._options">_options</a></span><span class="punctuation" data-toggle="tooltip" title="string">.</span><span data-toggle="tooltip" title="string"><a href="../src/Options.html#LiterateProgramming.Options.InputFolder">InputFolder</a></span><span class="punctuation">)</span><span class="punctuation">;</span>
				<span data-toggle="tooltip" title="LiterateProgramming.Weaver.GenerateFromFiles()"><a href="../src/Weaver.html#LiterateProgramming.Weaver.GenerateFromFiles()">GenerateFromFiles</a></span> <span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">;</span>
			<span class="punctuation">}</span>
			<span data-toggle="tooltip" title="LiterateProgramming.Weaver.ConsoleOut(string, params object[])"><a href="../src/Weaver.html#LiterateProgramming.Weaver.ConsoleOut(string, object[])">ConsoleOut</a></span> <span class="punctuation">(</span><span class="string" data-toggle="tooltip" title="string">&quot;Done.&quot;</span><span class="punctuation">)</span><span class="punctuation">;</span>
		<span class="punctuation">}</span>
</code></pre>
<h3 id="verbose-output">Verbose Output</h3>
<p>If verbose mode is active (<code>-v</code> option), information about the progress of
the tool is outputted to the console.</p>
<pre class="csharp"><code class="csharp">		<span class="keyword" id="LiterateProgramming.Weaver.ConsoleOut(string, object[])" data-toggle="tooltip" title="LiterateProgramming.Weaver.ConsoleOut(string, params object[])">protected</span> <span class="keyword" data-toggle="tooltip" title="void">void</span> <span data-toggle="tooltip" title="LiterateProgramming.Weaver.ConsoleOut(string, params object[])">ConsoleOut</span> <span class="punctuation">(</span><span class="keyword" data-toggle="tooltip" title="string">string</span> text<span class="punctuation">,</span> <span class="keyword">params</span> <span class="keyword" data-toggle="tooltip" title="object">object</span><span class="punctuation">[</span><span class="punctuation">]</span> args<span class="punctuation">)</span>
		<span class="punctuation">{</span>
			<span class="keyword">if</span> <span class="punctuation">(</span><span data-toggle="tooltip" title="LiterateProgramming.Options"><a href="../src/Weaver.html#LiterateProgramming.Weaver._options">_options</a></span><span class="punctuation" data-toggle="tooltip" title="bool">.</span><span data-toggle="tooltip" title="bool"><a href="../src/Options.html#LiterateProgramming.Options.Verbose">Verbose</a></span><span class="punctuation">)</span>
				<span class="typename" data-toggle="tooltip" title="System.Console">Console</span><span class="punctuation" data-toggle="tooltip" title="System.Console.WriteLine(string, params object[])">.</span><span data-toggle="tooltip" title="System.Console.WriteLine(string, params object[])">WriteLine</span> <span class="punctuation">(</span><span data-toggle="tooltip" title="string">text</span><span class="punctuation">,</span> <span data-toggle="tooltip" title="object[]">args</span><span class="punctuation">)</span><span class="punctuation">;</span>
		<span class="punctuation">}</span>
</code></pre>
<h3 id="output-path-for-a-file">Output Path for a File</h3>
<p>For each input file we need to construct the output path. We take the base
path from command line options and join it with the relative file path of
the input file changing the extension simultaneously. We also check that the
output directory exists, and create it when needed.</p>
<pre class="csharp"><code class="csharp">		<span class="keyword" id="LiterateProgramming.Weaver.CreateOutputPath(LiterateProgramming.SplitPath, string)" data-toggle="tooltip" title="LiterateProgramming.Weaver.CreateOutputPath(LiterateProgramming.SplitPath, string)">protected</span> <span class="typename" data-toggle="tooltip" title="LiterateProgramming.SplitPath"><a href="../src/SplitPath.html#LiterateProgramming.SplitPath">SplitPath</a></span> <span data-toggle="tooltip" title="LiterateProgramming.Weaver.CreateOutputPath(LiterateProgramming.SplitPath, string)">CreateOutputPath</span> <span class="punctuation">(</span><span class="typename" data-toggle="tooltip" title="LiterateProgramming.SplitPath"><a href="../src/SplitPath.html#LiterateProgramming.SplitPath">SplitPath</a></span> codeFile<span class="punctuation">,</span> <span class="keyword" data-toggle="tooltip" title="string">string</span> extension<span class="punctuation">)</span>
		<span class="punctuation">{</span>
			<span class="keyword" data-toggle="tooltip" title="LiterateProgramming.SplitPath">var</span> <span id="outputFile">outputFile</span> <span class="punctuation">=</span> <span data-toggle="tooltip" title="LiterateProgramming.Options"><a href="../src/Weaver.html#LiterateProgramming.Weaver._options">_options</a></span><span class="punctuation" data-toggle="tooltip" title="LiterateProgramming.SplitPath">.</span><span data-toggle="tooltip" title="LiterateProgramming.SplitPath"><a href="../src/Options.html#LiterateProgramming.Options.OutputPath">OutputPath</a></span> <span class="punctuation" data-toggle="tooltip" title="LiterateProgramming.SplitPath">+</span> <span data-toggle="tooltip" title="LiterateProgramming.SplitPath">codeFile</span><span class="punctuation" data-toggle="tooltip" title="LiterateProgramming.SplitPath.ChangeExtension(string)">.</span><span data-toggle="tooltip" title="LiterateProgramming.SplitPath.ChangeExtension(string)"><a href="../src/SplitPath.html#LiterateProgramming.SplitPath.ChangeExtension(string)">ChangeExtension</a></span> <span class="punctuation">(</span><span data-toggle="tooltip" title="string">extension</span><span class="punctuation">)</span><span class="punctuation">;</span>
			<span data-toggle="tooltip" title="LiterateProgramming.Weaver.ConsoleOut(string, params object[])"><a href="../src/Weaver.html#LiterateProgramming.Weaver.ConsoleOut(string, object[])">ConsoleOut</a></span> <span class="punctuation">(</span><span class="string" data-toggle="tooltip" title="string">&quot;Generating {0} from file &#39;{1}&#39; into file &#39;{2}&#39;&quot;</span><span class="punctuation">,</span>
				<span data-toggle="tooltip" title="string">extension</span><span class="punctuation">,</span> <span data-toggle="tooltip" title="LiterateProgramming.SplitPath">codeFile</span><span class="punctuation" data-toggle="tooltip" title="string">.</span><span data-toggle="tooltip" title="string"><a href="../src/SplitPath.html#LiterateProgramming.SplitPath.FilePath">FilePath</a></span><span class="punctuation">,</span> <span data-toggle="tooltip" title="LiterateProgramming.SplitPath">outputFile</span><span class="punctuation" data-toggle="tooltip" title="string">.</span><span data-toggle="tooltip" title="string"><a href="../src/SplitPath.html#LiterateProgramming.SplitPath.FilePath">FilePath</a></span><span class="punctuation">)</span><span class="punctuation">;</span>
			<span class="typename" data-toggle="tooltip" title="CSWeave.Theme.DirHelpers"><a href="../CSWeave.Theme/DirHelpers.html#CSWeave.Theme.DirHelpers">DirHelpers</a></span><span class="punctuation" data-toggle="tooltip" title="CSWeave.Theme.DirHelpers.EnsureExists(string)">.</span><span data-toggle="tooltip" title="CSWeave.Theme.DirHelpers.EnsureExists(string)"><a href="../CSWeave.Theme/DirHelpers.html#CSWeave.Theme.DirHelpers.EnsureExists(string)">EnsureExists</a></span> <span class="punctuation">(</span><span data-toggle="tooltip" title="LiterateProgramming.SplitPath">outputFile</span><span class="punctuation" data-toggle="tooltip" title="string">.</span><span data-toggle="tooltip" title="string"><a href="../src/SplitPath.html#LiterateProgramming.SplitPath.DirectoryName">DirectoryName</a></span><span class="punctuation">)</span><span class="punctuation">;</span>
			<span class="keyword">return</span> <span data-toggle="tooltip" title="LiterateProgramming.SplitPath">outputFile</span><span class="punctuation">;</span>
		<span class="punctuation">}</span>
</code></pre>
<h2 id="selecting-input-files">Selecting Input Files</h2>
<p>The subclasses can use the following methods to retrieve paths of he input
files. The methods use LINQ to enumerate the SplitPath structures that refer
to files in a directory or in a solution.</p>
<h3 id="enumerating-files-in-input-folder">Enumerating Files in Input Folder</h3>
<p>First variant returns all the files in the input directory that match the
specified filters. The filters are regular expressions that are constructed
from the glob patterns by the methods shown below.</p>
<pre class="csharp"><code class="csharp">		<span class="keyword" id="LiterateProgramming.Weaver.FilterRegexes()" data-toggle="tooltip" title="LiterateProgramming.Weaver.FilterRegexes()">protected</span> <span class="typename" data-toggle="tooltip" title="System.Text.RegularExpressions.Regex">Regex</span><span class="punctuation">[</span><span class="punctuation">]</span> <span data-toggle="tooltip" title="LiterateProgramming.Weaver.FilterRegexes()">FilterRegexes</span> <span class="punctuation">(</span><span class="punctuation">)</span>
		<span class="punctuation">{</span>
			<span class="keyword">return</span> <span class="punctuation" data-toggle="tooltip" title="?">(</span><span class="keyword">from</span> filt <span class="keyword">in</span> <span data-toggle="tooltip" title="LiterateProgramming.Options"><a href="../src/Weaver.html#LiterateProgramming.Weaver._options">_options</a></span><span class="punctuation" data-toggle="tooltip" title="System.Collections.Generic.IList<string>">.</span><span data-toggle="tooltip" title="System.Collections.Generic.IList<string>"><a href="../src/Options.html#LiterateProgramming.Options.Filters">Filters</a></span>
					<span class="keyword" data-toggle="tooltip" title="?">select</span> <span class="keyword" data-toggle="tooltip" title="System.Text.RegularExpressions.Regex">new</span> <span class="typename">Regex</span> <span class="punctuation">(</span><span data-toggle="tooltip" title="LiterateProgramming.Weaver.WildcardToRegex(string)"><a href="../src/Weaver.html#LiterateProgramming.Weaver.WildcardToRegex(string)">WildcardToRegex</a></span> <span class="punctuation">(</span><span data-toggle="tooltip" title="string">filt</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation" data-toggle="tooltip" title="?">)</span>
				   <span class="punctuation">.</span>ToArray <span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">;</span>
		<span class="punctuation">}</span>

		<span class="keyword" id="LiterateProgramming.Weaver.WildcardToRegex(string)" data-toggle="tooltip" title="LiterateProgramming.Weaver.WildcardToRegex(string)">protected</span> <span class="keyword" data-toggle="tooltip" title="LiterateProgramming.Weaver.WildcardToRegex(string)">static</span> <span class="keyword" data-toggle="tooltip" title="string">string</span> <span data-toggle="tooltip" title="LiterateProgramming.Weaver.WildcardToRegex(string)">WildcardToRegex</span> <span class="punctuation">(</span><span class="keyword" data-toggle="tooltip" title="string">string</span> pattern<span class="punctuation">)</span> <span class="punctuation">=&gt;</span>
			<span class="string" data-toggle="tooltip" title="string">&quot;^&quot;</span> <span class="punctuation" data-toggle="tooltip" title="string">+</span>
			<span class="typename" data-toggle="tooltip" title="System.Text.RegularExpressions.Regex">Regex</span><span class="punctuation" data-toggle="tooltip" title="System.Text.RegularExpressions.Regex.Escape(string)">.</span><span data-toggle="tooltip" title="System.Text.RegularExpressions.Regex.Escape(string)">Escape</span> <span class="punctuation">(</span><span data-toggle="tooltip" title="string">pattern</span><span class="punctuation" data-toggle="tooltip" title="string.Replace(char, char)">.</span><span data-toggle="tooltip" title="string.Replace(char, char)">Replace</span> <span class="punctuation">(</span>
				<span class="typename" data-toggle="tooltip" title="System.IO.Path">Path</span><span class="punctuation" data-toggle="tooltip" title="char">.</span><span data-toggle="tooltip" title="char">DirectorySeparatorChar</span> <span class="punctuation" data-toggle="tooltip" title="bool">==</span> <span data-toggle="tooltip" title="char">&#39;\\&#39;</span> <span class="punctuation" data-toggle="tooltip" title="char">?</span> <span data-toggle="tooltip" title="char">&#39;/&#39;</span> <span class="punctuation" data-toggle="tooltip" title="char">:</span> <span data-toggle="tooltip" title="char">&#39;\\&#39;</span><span class="punctuation">,</span> <span class="typename" data-toggle="tooltip" title="System.IO.Path">Path</span><span class="punctuation" data-toggle="tooltip" title="char">.</span><span data-toggle="tooltip" title="char">DirectorySeparatorChar</span><span class="punctuation">)</span><span class="punctuation">)</span>
			<span class="punctuation" data-toggle="tooltip" title="string.Replace(string, string)">.</span><span data-toggle="tooltip" title="string.Replace(string, string)">Replace</span> <span class="punctuation">(</span><span class="string" data-toggle="tooltip" title="string">@&quot;\*\*&quot;</span><span class="punctuation">,</span> <span class="string" data-toggle="tooltip" title="string">&quot;.*&quot;</span><span class="punctuation">)</span>
			<span class="punctuation" data-toggle="tooltip" title="string.Replace(string, string)">.</span><span data-toggle="tooltip" title="string.Replace(string, string)">Replace</span> <span class="punctuation">(</span><span class="string" data-toggle="tooltip" title="string">@&quot;\*&quot;</span><span class="punctuation">,</span> <span class="string" data-toggle="tooltip" title="string">&quot;[^\\\\/]*&quot;</span><span class="punctuation">)</span>
			<span class="punctuation" data-toggle="tooltip" title="string.Replace(string, string)">.</span><span data-toggle="tooltip" title="string.Replace(string, string)">Replace</span> <span class="punctuation">(</span><span class="string" data-toggle="tooltip" title="string">@&quot;\?&quot;</span><span class="punctuation">,</span> <span class="string" data-toggle="tooltip" title="string">&quot;.&quot;</span><span class="punctuation">)</span>
			<span class="punctuation" data-toggle="tooltip" title="string">+</span> <span class="string" data-toggle="tooltip" title="string">&quot;$&quot;</span><span class="punctuation" data-toggle="tooltip" title="LiterateProgramming.Weaver.WildcardToRegex(string)">;</span>
</code></pre>
<p>Now we can enumerate the input files.</p>
<pre class="csharp"><code class="csharp">		<span class="keyword" id="LiterateProgramming.Weaver.InputFiles()" data-toggle="tooltip" title="LiterateProgramming.Weaver.InputFiles()">protected</span> <span class="typename" data-toggle="tooltip" title="System.Collections.Generic.IEnumerable<LiterateProgramming.SplitPath>">IEnumerable</span><span class="punctuation">&lt;</span><span class="typename" data-toggle="tooltip" title="LiterateProgramming.SplitPath"><a href="../src/SplitPath.html#LiterateProgramming.SplitPath">SplitPath</a></span><span class="punctuation">&gt;</span> <span data-toggle="tooltip" title="LiterateProgramming.Weaver.InputFiles()">InputFiles</span> <span class="punctuation">(</span><span class="punctuation">)</span>
		<span class="punctuation">{</span>
			<span class="keyword" data-toggle="tooltip" title="System.Text.RegularExpressions.Regex[]">var</span> <span id="filtRegexes">filtRegexes</span> <span class="punctuation">=</span> <span data-toggle="tooltip" title="LiterateProgramming.Weaver.FilterRegexes()"><a href="../src/Weaver.html#LiterateProgramming.Weaver.FilterRegexes()">FilterRegexes</a></span> <span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">;</span>
			<span class="keyword">return</span> <span class="keyword">from</span> file <span class="keyword">in</span> <span class="typename" data-toggle="tooltip" title="CSWeave.Theme.DirHelpers"><a href="../CSWeave.Theme/DirHelpers.html#CSWeave.Theme.DirHelpers">DirHelpers</a></span><span class="punctuation" data-toggle="tooltip" title="CSWeave.Theme.DirHelpers.Dir(string, string, bool)">.</span><span data-toggle="tooltip" title="CSWeave.Theme.DirHelpers.Dir(string, string, bool)"><a href="../CSWeave.Theme/DirHelpers.html#CSWeave.Theme.DirHelpers.Dir(string, string, bool)">Dir</a></span> <span class="punctuation">(</span><span data-toggle="tooltip" title="LiterateProgramming.Options"><a href="../src/Weaver.html#LiterateProgramming.Weaver._options">_options</a></span><span class="punctuation" data-toggle="tooltip" title="LiterateProgramming.SplitPath">.</span><span data-toggle="tooltip" title="LiterateProgramming.SplitPath"><a href="../src/Options.html#LiterateProgramming.Options.InputPath">InputPath</a></span><span class="punctuation" data-toggle="tooltip" title="string">.</span><span data-toggle="tooltip" title="string"><a href="../src/SplitPath.html#LiterateProgramming.SplitPath.BasePath">BasePath</a></span><span class="punctuation">,</span> <span class="string" data-toggle="tooltip" title="string">&quot;*&quot;</span><span class="punctuation">,</span>
						<span data-toggle="tooltip" title="LiterateProgramming.Options"><a href="../src/Weaver.html#LiterateProgramming.Weaver._options">_options</a></span><span class="punctuation" data-toggle="tooltip" title="bool">.</span><span data-toggle="tooltip" title="bool"><a href="../src/Options.html#LiterateProgramming.Options.Recursive">Recursive</a></span><span class="punctuation">)</span>
				   <span class="keyword">let</span> relPath <span class="punctuation">=</span> <span class="typename" data-toggle="tooltip" title="LiterateProgramming.SplitPath"><a href="../src/SplitPath.html#LiterateProgramming.SplitPath">SplitPath</a></span><span class="punctuation" data-toggle="tooltip" title="LiterateProgramming.SplitPath.Split(string, string)">.</span><span data-toggle="tooltip" title="LiterateProgramming.SplitPath.Split(string, string)"><a href="../src/SplitPath.html#LiterateProgramming.SplitPath.Split(string, string)">Split</a></span> <span class="punctuation">(</span><span data-toggle="tooltip" title="LiterateProgramming.Options"><a href="../src/Weaver.html#LiterateProgramming.Weaver._options">_options</a></span><span class="punctuation" data-toggle="tooltip" title="LiterateProgramming.SplitPath">.</span><span data-toggle="tooltip" title="LiterateProgramming.SplitPath"><a href="../src/Options.html#LiterateProgramming.Options.InputPath">InputPath</a></span><span class="punctuation" data-toggle="tooltip" title="string">.</span><span data-toggle="tooltip" title="string"><a href="../src/SplitPath.html#LiterateProgramming.SplitPath.BasePath">BasePath</a></span><span class="punctuation">,</span> <span data-toggle="tooltip" title="string">file</span><span class="punctuation">)</span>
				   <span class="keyword">where</span> <span data-toggle="tooltip" title="System.Text.RegularExpressions.Regex[]">filtRegexes</span><span class="punctuation" data-toggle="tooltip" title="System.Collections.Generic.IEnumerable<System.Text.RegularExpressions.Regex>.Any<System.Text.RegularExpressions.Regex>(System.Func<System.Text.RegularExpressions.Regex, bool>)">.</span><span data-toggle="tooltip" title="System.Collections.Generic.IEnumerable<System.Text.RegularExpressions.Regex>.Any<System.Text.RegularExpressions.Regex>(System.Func<System.Text.RegularExpressions.Regex, bool>)">Any</span> <span class="punctuation">(</span>re <span class="punctuation" data-toggle="tooltip" title="lambda expression">=&gt;</span> <span data-toggle="tooltip" title="System.Text.RegularExpressions.Regex">re</span><span class="punctuation" data-toggle="tooltip" title="System.Text.RegularExpressions.Regex.IsMatch(string, string)">.</span><span data-toggle="tooltip" title="System.Text.RegularExpressions.Regex.IsMatch(string, string)">IsMatch</span> <span class="punctuation">(</span><span data-toggle="tooltip" title="?">relPath</span><span class="punctuation" data-toggle="tooltip" title="?">.</span><span data-toggle="tooltip" title="?">FilePath</span><span class="punctuation">)</span><span class="punctuation">)</span>
				   <span class="keyword" data-toggle="tooltip" title="?">select</span> <span data-toggle="tooltip" title="?">relPath</span><span class="punctuation">;</span>
		<span class="punctuation">}</span>
</code></pre>
<p>We define also helpers to enumerate just code or markdown files.</p>
<pre class="csharp"><code class="csharp">		<span class="keyword" id="LiterateProgramming.Weaver.MarkdownFiles()" data-toggle="tooltip" title="LiterateProgramming.Weaver.MarkdownFiles()">protected</span> <span class="typename" data-toggle="tooltip" title="System.Collections.Generic.IEnumerable<LiterateProgramming.SplitPath>">IEnumerable</span><span class="punctuation">&lt;</span><span class="typename" data-toggle="tooltip" title="LiterateProgramming.SplitPath"><a href="../src/SplitPath.html#LiterateProgramming.SplitPath">SplitPath</a></span><span class="punctuation">&gt;</span> <span data-toggle="tooltip" title="LiterateProgramming.Weaver.MarkdownFiles()">MarkdownFiles</span> <span class="punctuation">(</span><span class="punctuation">)</span>
		<span class="punctuation">{</span>
			<span class="keyword">return</span> <span data-toggle="tooltip" title="LiterateProgramming.Weaver.InputFiles()"><a href="../src/Weaver.html#LiterateProgramming.Weaver.InputFiles()">InputFiles</a></span> <span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation" data-toggle="tooltip" title="System.Collections.Generic.IEnumerable<LiterateProgramming.SplitPath>.Where<LiterateProgramming.SplitPath>(System.Func<LiterateProgramming.SplitPath, bool>)">.</span><span data-toggle="tooltip" title="System.Collections.Generic.IEnumerable<LiterateProgramming.SplitPath>.Where<LiterateProgramming.SplitPath>(System.Func<LiterateProgramming.SplitPath, bool>)">Where</span> <span class="punctuation">(</span><span data-toggle="tooltip" title="LiterateProgramming.Weaver.IsMarkdownFile(LiterateProgramming.SplitPath)"><a href="../src/Weaver.html#LiterateProgramming.Weaver.IsMarkdownFile(LiterateProgramming.SplitPath)">IsMarkdownFile</a></span><span class="punctuation">)</span><span class="punctuation">;</span>
		<span class="punctuation">}</span>

		<span class="keyword" id="LiterateProgramming.Weaver.SourceFiles()" data-toggle="tooltip" title="LiterateProgramming.Weaver.SourceFiles()">protected</span> <span class="typename" data-toggle="tooltip" title="System.Collections.Generic.IEnumerable<LiterateProgramming.SplitPath>">IEnumerable</span><span class="punctuation">&lt;</span><span class="typename" data-toggle="tooltip" title="LiterateProgramming.SplitPath"><a href="../src/SplitPath.html#LiterateProgramming.SplitPath">SplitPath</a></span><span class="punctuation">&gt;</span> <span data-toggle="tooltip" title="LiterateProgramming.Weaver.SourceFiles()">SourceFiles</span> <span class="punctuation">(</span><span class="punctuation">)</span>
		<span class="punctuation">{</span>
			<span class="keyword">return</span> <span data-toggle="tooltip" title="LiterateProgramming.Weaver.InputFiles()"><a href="../src/Weaver.html#LiterateProgramming.Weaver.InputFiles()">InputFiles</a></span> <span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation" data-toggle="tooltip" title="System.Collections.Generic.IEnumerable<LiterateProgramming.SplitPath>.Where<LiterateProgramming.SplitPath>(System.Func<LiterateProgramming.SplitPath, bool>)">.</span><span data-toggle="tooltip" title="System.Collections.Generic.IEnumerable<LiterateProgramming.SplitPath>.Where<LiterateProgramming.SplitPath>(System.Func<LiterateProgramming.SplitPath, bool>)">Where</span> <span class="punctuation">(</span><span data-toggle="tooltip" title="LiterateProgramming.Weaver.IsSourceFile(LiterateProgramming.SplitPath)"><a href="../src/Weaver.html#LiterateProgramming.Weaver.IsSourceFile(LiterateProgramming.SplitPath)">IsSourceFile</a></span><span class="punctuation">)</span><span class="punctuation">;</span>
		<span class="punctuation">}</span>
</code></pre>
<h3 id="enumerating-files-in-solution">Enumerating Files in Solution</h3>
<p>When a solution file is used as an input, markdown and C# files are retrieved
separately. This is because the markdown files are not visible in MSBuild
Workspace provided by Roslyn. Apparently Roslyn is only interested in the C#
source files. We need the classes provided by the <code>Microsoft.Build.Construction</code>
library to access all files in a solution.</p>
<p>First let's collect the markdown files from a solution file. Note that the LINQ
query assumes the &quot;Build Action&quot; property of the retrieved files to be either
&quot;Content&quot; or &quot;None&quot;. Files having other build types are skipped.</p>
<pre class="csharp"><code class="csharp">		<span class="keyword" id="LiterateProgramming.Weaver.MarkdownFilesInSolution(Microsoft.Build.Construction.SolutionFile)" data-toggle="tooltip" title="LiterateProgramming.Weaver.MarkdownFilesInSolution(Microsoft.Build.Construction.SolutionFile)">protected</span> <span class="typename" data-toggle="tooltip" title="System.Collections.Generic.IEnumerable<LiterateProgramming.SplitPath>">IEnumerable</span><span class="punctuation">&lt;</span><span class="typename" data-toggle="tooltip" title="LiterateProgramming.SplitPath"><a href="../src/SplitPath.html#LiterateProgramming.SplitPath">SplitPath</a></span><span class="punctuation">&gt;</span> <span data-toggle="tooltip" title="LiterateProgramming.Weaver.MarkdownFilesInSolution(Microsoft.Build.Construction.SolutionFile)">MarkdownFilesInSolution</span> <span class="punctuation">(</span><span class="typename" data-toggle="tooltip" title="Microsoft.Build.Construction.SolutionFile">SolutionFile</span> solution<span class="punctuation">)</span>
		<span class="punctuation">{</span>
			<span class="keyword" data-toggle="tooltip" title="System.Text.RegularExpressions.Regex[]">var</span> filtRegexes <span class="punctuation">=</span> <span data-toggle="tooltip" title="LiterateProgramming.Weaver.FilterRegexes()"><a href="../src/Weaver.html#LiterateProgramming.Weaver.FilterRegexes()">FilterRegexes</a></span> <span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">;</span>
			<span class="keyword">return</span> <span class="keyword">from</span> proj <span class="keyword">in</span> <span data-toggle="tooltip" title="Microsoft.Build.Construction.SolutionFile">solution</span><span class="punctuation" data-toggle="tooltip" title="System.Collections.Generic.IReadOnlyList<Microsoft.Build.Construction.ProjectInSolution>">.</span><span data-toggle="tooltip" title="System.Collections.Generic.IReadOnlyList<Microsoft.Build.Construction.ProjectInSolution>">ProjectsInOrder</span>
				   <span class="keyword">where</span> <span data-toggle="tooltip" title="Microsoft.Build.Construction.ProjectInSolution">proj</span><span class="punctuation" data-toggle="tooltip" title="Microsoft.Build.Construction.SolutionProjectType">.</span><span data-toggle="tooltip" title="Microsoft.Build.Construction.SolutionProjectType">ProjectType</span> <span class="punctuation" data-toggle="tooltip" title="bool">==</span> <span class="typename" data-toggle="tooltip" title="Microsoft.Build.Construction.SolutionProjectType">SolutionProjectType</span><span class="punctuation" data-toggle="tooltip" title="Microsoft.Build.Construction.SolutionProjectType">.</span><span data-toggle="tooltip" title="Microsoft.Build.Construction.SolutionProjectType">KnownToBeMSBuildFormat</span>
				   <span class="keyword">let</span> root <span class="punctuation">=</span> <span class="typename" data-toggle="tooltip" title="Microsoft.Build.Construction.ProjectRootElement">ProjectRootElement</span><span class="punctuation" data-toggle="tooltip" title="Microsoft.Build.Construction.ProjectRootElement.Open(string)">.</span><span data-toggle="tooltip" title="Microsoft.Build.Construction.ProjectRootElement.Open(string)">Open</span> <span class="punctuation">(</span><span data-toggle="tooltip" title="?">proj</span><span class="punctuation" data-toggle="tooltip" title="?">.</span><span data-toggle="tooltip" title="?">AbsolutePath</span><span class="punctuation">)</span>
				   <span class="keyword">from</span> item <span class="keyword">in</span> <span data-toggle="tooltip" title="?">root</span><span class="punctuation" data-toggle="tooltip" title="?">.</span><span data-toggle="tooltip" title="?">Items</span>
				   <span class="keyword">where</span> <span data-toggle="tooltip" title="?">item</span><span class="punctuation" data-toggle="tooltip" title="?">.</span><span data-toggle="tooltip" title="?">ItemType</span><span class="punctuation">.</span>In <span class="punctuation">(</span><span class="string" data-toggle="tooltip" title="string">&quot;Content&quot;</span><span class="punctuation">,</span> <span class="string" data-toggle="tooltip" title="string">&quot;None&quot;</span><span class="punctuation">)</span>
				   <span class="keyword">let</span> relPath <span class="punctuation">=</span> <span data-toggle="tooltip" title="LiterateProgramming.Options"><a href="../src/Weaver.html#LiterateProgramming.Weaver._options">_options</a></span><span class="punctuation" data-toggle="tooltip" title="LiterateProgramming.SplitPath">.</span><span data-toggle="tooltip" title="LiterateProgramming.SplitPath"><a href="../src/Options.html#LiterateProgramming.Options.InputPath">InputPath</a></span><span class="punctuation" data-toggle="tooltip" title="LiterateProgramming.SplitPath.WithFile(string)">.</span><span data-toggle="tooltip" title="LiterateProgramming.SplitPath.WithFile(string)"><a href="../src/SplitPath.html#LiterateProgramming.SplitPath.WithFile(string)">WithFile</a></span> <span class="punctuation">(</span><span data-toggle="tooltip" title="?">item</span><span class="punctuation" data-toggle="tooltip" title="?">.</span><span data-toggle="tooltip" title="?">Include</span><span class="punctuation">)</span>
				   <span class="keyword">where</span> <span data-toggle="tooltip" title="LiterateProgramming.Weaver.IsMarkdownFile(LiterateProgramming.SplitPath)"><a href="../src/Weaver.html#LiterateProgramming.Weaver.IsMarkdownFile(LiterateProgramming.SplitPath)">IsMarkdownFile</a></span> <span class="punctuation">(</span><span data-toggle="tooltip" title="?">relPath</span><span class="punctuation">)</span> <span class="punctuation" data-toggle="tooltip" title="?">&amp;&amp;</span>
					   <span data-toggle="tooltip" title="System.Text.RegularExpressions.Regex[]">filtRegexes</span><span class="punctuation" data-toggle="tooltip" title="System.Collections.Generic.IEnumerable<System.Text.RegularExpressions.Regex>.Any<System.Text.RegularExpressions.Regex>(System.Func<System.Text.RegularExpressions.Regex, bool>)">.</span><span data-toggle="tooltip" title="System.Collections.Generic.IEnumerable<System.Text.RegularExpressions.Regex>.Any<System.Text.RegularExpressions.Regex>(System.Func<System.Text.RegularExpressions.Regex, bool>)">Any</span> <span class="punctuation">(</span>re <span class="punctuation" data-toggle="tooltip" title="lambda expression">=&gt;</span> <span data-toggle="tooltip" title="System.Text.RegularExpressions.Regex">re</span><span class="punctuation" data-toggle="tooltip" title="System.Text.RegularExpressions.Regex.IsMatch(string, string)">.</span><span data-toggle="tooltip" title="System.Text.RegularExpressions.Regex.IsMatch(string, string)">IsMatch</span> <span class="punctuation">(</span><span data-toggle="tooltip" title="?">relPath</span><span class="punctuation" data-toggle="tooltip" title="?">.</span><span data-toggle="tooltip" title="?">FilePath</span><span class="punctuation">)</span><span class="punctuation">)</span>
				   <span class="keyword" data-toggle="tooltip" title="?">select</span> <span data-toggle="tooltip" title="?">relPath</span><span class="punctuation">;</span>
		<span class="punctuation">}</span>
</code></pre>
<p>And then we can gather the C# source files. Most of the heavy lifting is
delegated to the MSBuildHelper class. In addition to the file path we
return also the Document object that contains syntactic and semantic
information that the Roslyn compiler attaches to the source file.</p>
<pre class="csharp"><code class="csharp">		<span class="keyword" id="LiterateProgramming.Weaver.CSharpDocumentsInSolution(Microsoft.Build.Construction.SolutionFile)" data-toggle="tooltip" title="LiterateProgramming.Weaver.CSharpDocumentsInSolution(Microsoft.Build.Construction.SolutionFile)">protected</span> <span class="typename" data-toggle="tooltip" title="System.Collections.Generic.IEnumerable<System.Tuple<LiterateProgramming.SplitPath, Microsoft.CodeAnalysis.Document>>">IEnumerable</span><span class="punctuation">&lt;</span><span class="typename" data-toggle="tooltip" title="System.Tuple<LiterateProgramming.SplitPath, Microsoft.CodeAnalysis.Document>">Tuple</span><span class="punctuation">&lt;</span><span class="typename" data-toggle="tooltip" title="LiterateProgramming.SplitPath"><a href="../src/SplitPath.html#LiterateProgramming.SplitPath">SplitPath</a></span><span class="punctuation">,</span> <span class="typename" data-toggle="tooltip" title="Microsoft.CodeAnalysis.Document">Document</span><span class="punctuation">&gt;</span><span class="punctuation">&gt;</span> <span data-toggle="tooltip" title="LiterateProgramming.Weaver.CSharpDocumentsInSolution(Microsoft.Build.Construction.SolutionFile)">CSharpDocumentsInSolution</span> <span class="punctuation">(</span>
			<span class="typename" data-toggle="tooltip" title="Microsoft.Build.Construction.SolutionFile">SolutionFile</span> solutionFile<span class="punctuation">)</span>
		<span class="punctuation">{</span>
			<span class="keyword" data-toggle="tooltip" title="Microsoft.CodeAnalysis.MSBuild.MSBuildWorkspace">var</span> <span id="workspace">workspace</span> <span class="punctuation">=</span> <span class="typename" data-toggle="tooltip" title="Microsoft.CodeAnalysis.MSBuild.MSBuildWorkspace">MSBuildWorkspace</span><span class="punctuation" data-toggle="tooltip" title="Microsoft.CodeAnalysis.MSBuild.MSBuildWorkspace.Create()">.</span><span data-toggle="tooltip" title="Microsoft.CodeAnalysis.MSBuild.MSBuildWorkspace.Create()">Create</span> <span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">;</span>
			<span class="keyword" data-toggle="tooltip" title="Microsoft.CodeAnalysis.Solution">var</span> <span id="solution">solution</span> <span class="punctuation">=</span> <span data-toggle="tooltip" title="Microsoft.CodeAnalysis.MSBuild.MSBuildWorkspace">workspace</span><span class="punctuation" data-toggle="tooltip" title="Microsoft.CodeAnalysis.MSBuild.MSBuildWorkspace.OpenSolutionAsync(string, System.Threading.CancellationToken)">.</span><span data-toggle="tooltip" title="Microsoft.CodeAnalysis.MSBuild.MSBuildWorkspace.OpenSolutionAsync(string, System.Threading.CancellationToken)">OpenSolutionAsync</span> <span class="punctuation">(</span><span data-toggle="tooltip" title="LiterateProgramming.Options"><a href="../src/Weaver.html#LiterateProgramming.Weaver._options">_options</a></span><span class="punctuation" data-toggle="tooltip" title="string">.</span><span data-toggle="tooltip" title="string"><a href="../src/Options.html#LiterateProgramming.Options.Solution">Solution</a></span><span class="punctuation">)</span><span class="punctuation" data-toggle="tooltip" title="Microsoft.CodeAnalysis.Solution">.</span><span data-toggle="tooltip" title="Microsoft.CodeAnalysis.Solution">Result</span><span class="punctuation">;</span>
			<span class="keyword" data-toggle="tooltip" title="System.Text.RegularExpressions.Regex[]">var</span> filtRegexes <span class="punctuation">=</span> <span data-toggle="tooltip" title="LiterateProgramming.Weaver.FilterRegexes()"><a href="../src/Weaver.html#LiterateProgramming.Weaver.FilterRegexes()">FilterRegexes</a></span> <span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">;</span>
			<span class="keyword">return</span> <span class="keyword">from</span> proj <span class="keyword">in</span> <span class="typename" data-toggle="tooltip" title="LiterateProgramming.MSBuildHelpers"><a href="../src/MSBuildHelpers.html#LiterateProgramming.MSBuildHelpers">MSBuildHelpers</a></span><span class="punctuation" data-toggle="tooltip" title="LiterateProgramming.MSBuildHelpers.LoadProjectsInSolution(Microsoft.CodeAnalysis.Solution, Microsoft.Build.Construction.SolutionFile)">.</span><span data-toggle="tooltip" title="LiterateProgramming.MSBuildHelpers.LoadProjectsInSolution(Microsoft.CodeAnalysis.Solution, Microsoft.Build.Construction.SolutionFile)"><a href="../src/MSBuildHelpers.html#LiterateProgramming.MSBuildHelpers.LoadProjectsInSolution(Microsoft.CodeAnalysis.Solution, Microsoft.Build.Construction.SolutionFile)">LoadProjectsInSolution</a></span> <span class="punctuation">(</span><span data-toggle="tooltip" title="Microsoft.CodeAnalysis.Solution">solution</span><span class="punctuation">,</span> <span data-toggle="tooltip" title="Microsoft.Build.Construction.SolutionFile">solutionFile</span><span class="punctuation">)</span>
				   <span class="keyword">from</span> doc <span class="keyword">in</span> <span data-toggle="tooltip" title="Microsoft.CodeAnalysis.Project">proj</span><span class="punctuation" data-toggle="tooltip" title="System.Collections.Generic.IEnumerable<Microsoft.CodeAnalysis.Document>">.</span><span data-toggle="tooltip" title="System.Collections.Generic.IEnumerable<Microsoft.CodeAnalysis.Document>">Documents</span>
				   <span class="keyword">let</span> relPath <span class="punctuation">=</span> <span class="typename" data-toggle="tooltip" title="LiterateProgramming.SplitPath"><a href="../src/SplitPath.html#LiterateProgramming.SplitPath">SplitPath</a></span><span class="punctuation" data-toggle="tooltip" title="LiterateProgramming.SplitPath.Split(string, string)">.</span><span data-toggle="tooltip" title="LiterateProgramming.SplitPath.Split(string, string)"><a href="../src/SplitPath.html#LiterateProgramming.SplitPath.Split(string, string)">Split</a></span> <span class="punctuation">(</span><span data-toggle="tooltip" title="LiterateProgramming.Options"><a href="../src/Weaver.html#LiterateProgramming.Weaver._options">_options</a></span><span class="punctuation" data-toggle="tooltip" title="LiterateProgramming.SplitPath">.</span><span data-toggle="tooltip" title="LiterateProgramming.SplitPath"><a href="../src/Options.html#LiterateProgramming.Options.InputPath">InputPath</a></span><span class="punctuation" data-toggle="tooltip" title="string">.</span><span data-toggle="tooltip" title="string"><a href="../src/SplitPath.html#LiterateProgramming.SplitPath.BasePath">BasePath</a></span><span class="punctuation">,</span> <span data-toggle="tooltip" title="?">doc</span><span class="punctuation" data-toggle="tooltip" title="?">.</span><span data-toggle="tooltip" title="?">FilePath</span><span class="punctuation">)</span>
				   <span class="keyword">where</span> <span data-toggle="tooltip" title="System.Text.RegularExpressions.Regex[]">filtRegexes</span><span class="punctuation" data-toggle="tooltip" title="System.Collections.Generic.IEnumerable<System.Text.RegularExpressions.Regex>.Any<System.Text.RegularExpressions.Regex>(System.Func<System.Text.RegularExpressions.Regex, bool>)">.</span><span data-toggle="tooltip" title="System.Collections.Generic.IEnumerable<System.Text.RegularExpressions.Regex>.Any<System.Text.RegularExpressions.Regex>(System.Func<System.Text.RegularExpressions.Regex, bool>)">Any</span> <span class="punctuation">(</span>re <span class="punctuation" data-toggle="tooltip" title="lambda expression">=&gt;</span> <span data-toggle="tooltip" title="System.Text.RegularExpressions.Regex">re</span><span class="punctuation" data-toggle="tooltip" title="System.Text.RegularExpressions.Regex.IsMatch(string, string)">.</span><span data-toggle="tooltip" title="System.Text.RegularExpressions.Regex.IsMatch(string, string)">IsMatch</span> <span class="punctuation">(</span><span data-toggle="tooltip" title="?">relPath</span><span class="punctuation" data-toggle="tooltip" title="?">.</span><span data-toggle="tooltip" title="?">FilePath</span><span class="punctuation">)</span><span class="punctuation">)</span>
				   <span class="keyword" data-toggle="tooltip" title="?">select</span> <span class="typename" data-toggle="tooltip" title="System.Tuple">Tuple</span><span class="punctuation" data-toggle="tooltip" title="System.Tuple.Create<T1>(T1)">.</span><span data-toggle="tooltip" title="System.Tuple.Create<T1>(T1)">Create</span> <span class="punctuation">(</span><span data-toggle="tooltip" title="?">relPath</span><span class="punctuation">,</span> <span data-toggle="tooltip" title="?">doc</span><span class="punctuation">)</span><span class="punctuation">;</span>
		<span class="punctuation">}</span>
</code></pre>
<p>We need some helper functions to determine the type of a file. The type of a file
is deduced from its extension or from its name.</p>
<pre class="csharp"><code class="csharp">		<span class="keyword" id="LiterateProgramming.Weaver.IsSourceFile(LiterateProgramming.SplitPath)" data-toggle="tooltip" title="LiterateProgramming.Weaver.IsSourceFile(LiterateProgramming.SplitPath)">protected</span> <span class="keyword" data-toggle="tooltip" title="bool">bool</span> <span data-toggle="tooltip" title="LiterateProgramming.Weaver.IsSourceFile(LiterateProgramming.SplitPath)">IsSourceFile</span> <span class="punctuation">(</span><span class="typename" data-toggle="tooltip" title="LiterateProgramming.SplitPath"><a href="../src/SplitPath.html#LiterateProgramming.SplitPath">SplitPath</a></span> file<span class="punctuation">)</span> <span class="punctuation">=&gt;</span>
			<span data-toggle="tooltip" title="LiterateProgramming.SplitPath">file</span><span class="punctuation" data-toggle="tooltip" title="string">.</span><span data-toggle="tooltip" title="string"><a href="../src/SplitPath.html#LiterateProgramming.SplitPath.Extension">Extension</a></span> <span class="punctuation" data-toggle="tooltip" title="bool">==</span> <span data-toggle="tooltip" title="LiterateProgramming.Options"><a href="../src/Weaver.html#LiterateProgramming.Weaver._options">_options</a></span><span class="punctuation" data-toggle="tooltip" title="string">.</span><span data-toggle="tooltip" title="string"><a href="../src/Options.html#LiterateProgramming.Options.SourceExt">SourceExt</a></span><span class="punctuation" data-toggle="tooltip" title="LiterateProgramming.Weaver.IsSourceFile(LiterateProgramming.SplitPath)">;</span>

		<span class="keyword" id="LiterateProgramming.Weaver.IsMarkdownFile(LiterateProgramming.SplitPath)" data-toggle="tooltip" title="LiterateProgramming.Weaver.IsMarkdownFile(LiterateProgramming.SplitPath)">protected</span> <span class="keyword" data-toggle="tooltip" title="bool">bool</span> <span data-toggle="tooltip" title="LiterateProgramming.Weaver.IsMarkdownFile(LiterateProgramming.SplitPath)">IsMarkdownFile</span> <span class="punctuation">(</span><span class="typename" data-toggle="tooltip" title="LiterateProgramming.SplitPath"><a href="../src/SplitPath.html#LiterateProgramming.SplitPath">SplitPath</a></span> file<span class="punctuation">)</span> <span class="punctuation">=&gt;</span>
			<span data-toggle="tooltip" title="LiterateProgramming.SplitPath">file</span><span class="punctuation" data-toggle="tooltip" title="string">.</span><span data-toggle="tooltip" title="string"><a href="../src/SplitPath.html#LiterateProgramming.SplitPath.Extension">Extension</a></span> <span class="punctuation" data-toggle="tooltip" title="bool">==</span> <span data-toggle="tooltip" title="LiterateProgramming.Options"><a href="../src/Weaver.html#LiterateProgramming.Weaver._options">_options</a></span><span class="punctuation" data-toggle="tooltip" title="string">.</span><span data-toggle="tooltip" title="string"><a href="../src/Options.html#LiterateProgramming.Options.MarkdownExt">MarkdownExt</a></span><span class="punctuation" data-toggle="tooltip" title="LiterateProgramming.Weaver.IsMarkdownFile(LiterateProgramming.SplitPath)">;</span>
</code></pre>
<p>The following three helper functions construct a block list from a markdown file,
source file or Roslyn document. They are used by the subclasses.</p>
<pre class="csharp"><code class="csharp">		<span class="keyword" id="LiterateProgramming.Weaver.BlockListFromMarkdown(string)" data-toggle="tooltip" title="LiterateProgramming.Weaver.BlockListFromMarkdown(string)">protected</span> <span class="typename" data-toggle="tooltip" title="LiterateProgramming.BlockList"><a href="../src/BlockList.html#LiterateProgramming.BlockList">BlockList</a></span> <span data-toggle="tooltip" title="LiterateProgramming.Weaver.BlockListFromMarkdown(string)">BlockListFromMarkdown</span> <span class="punctuation">(</span><span class="keyword" data-toggle="tooltip" title="string">string</span> mdFile<span class="punctuation">)</span> <span class="punctuation">=&gt;</span>
			<span data-toggle="tooltip" title="LiterateProgramming.Weaver.CreateBlockBuilder()"><a href="../src/Weaver.html#LiterateProgramming.Weaver.CreateBlockBuilder()">CreateBlockBuilder</a></span> <span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation" data-toggle="tooltip" title="LiterateProgramming.BlockBuilder.FromMdFile(string)">.</span><span data-toggle="tooltip" title="LiterateProgramming.BlockBuilder.FromMdFile(string)"><a href="../src/BlockBuilder.html#LiterateProgramming.BlockBuilder.FromMdFile(string)">FromMdFile</a></span> <span class="punctuation">(</span><span data-toggle="tooltip" title="string">mdFile</span><span class="punctuation">)</span><span class="punctuation" data-toggle="tooltip" title="LiterateProgramming.Weaver.BlockListFromMarkdown(string)">;</span>

		<span class="keyword" id="LiterateProgramming.Weaver.BlockListFromCode(string)" data-toggle="tooltip" title="LiterateProgramming.Weaver.BlockListFromCode(string)">protected</span> <span class="typename" data-toggle="tooltip" title="LiterateProgramming.BlockList"><a href="../src/BlockList.html#LiterateProgramming.BlockList">BlockList</a></span> <span data-toggle="tooltip" title="LiterateProgramming.Weaver.BlockListFromCode(string)">BlockListFromCode</span> <span class="punctuation">(</span><span class="keyword" data-toggle="tooltip" title="string">string</span> codeFile<span class="punctuation">)</span> <span class="punctuation">=&gt;</span>
			<span data-toggle="tooltip" title="LiterateProgramming.Weaver.CreateBlockBuilder()"><a href="../src/Weaver.html#LiterateProgramming.Weaver.CreateBlockBuilder()">CreateBlockBuilder</a></span> <span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation" data-toggle="tooltip" title="LiterateProgramming.BlockBuilder.FromCodeFile(string)">.</span><span data-toggle="tooltip" title="LiterateProgramming.BlockBuilder.FromCodeFile(string)"><a href="../src/BlockBuilder.html#LiterateProgramming.BlockBuilder.FromCodeFile(string)">FromCodeFile</a></span> <span class="punctuation">(</span><span data-toggle="tooltip" title="string">codeFile</span><span class="punctuation">)</span><span class="punctuation" data-toggle="tooltip" title="LiterateProgramming.Weaver.BlockListFromCode(string)">;</span>

		<span class="keyword" id="LiterateProgramming.Weaver.BlockListFromDocument(Microsoft.CodeAnalysis.Document)" data-toggle="tooltip" title="LiterateProgramming.Weaver.BlockListFromDocument(Microsoft.CodeAnalysis.Document)">protected</span> <span class="typename" data-toggle="tooltip" title="LiterateProgramming.BlockList"><a href="../src/BlockList.html#LiterateProgramming.BlockList">BlockList</a></span> <span data-toggle="tooltip" title="LiterateProgramming.Weaver.BlockListFromDocument(Microsoft.CodeAnalysis.Document)">BlockListFromDocument</span> <span class="punctuation">(</span><span class="typename" data-toggle="tooltip" title="Microsoft.CodeAnalysis.Document">Document</span> document<span class="punctuation">)</span> <span class="punctuation">=&gt;</span>
			<span data-toggle="tooltip" title="LiterateProgramming.Weaver.CreateBlockBuilder()"><a href="../src/Weaver.html#LiterateProgramming.Weaver.CreateBlockBuilder()">CreateBlockBuilder</a></span> <span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation" data-toggle="tooltip" title="LiterateProgramming.BlockBuilder.FromDocument(Microsoft.CodeAnalysis.Document)">.</span><span data-toggle="tooltip" title="LiterateProgramming.BlockBuilder.FromDocument(Microsoft.CodeAnalysis.Document)"><a href="../src/BlockBuilder.html#LiterateProgramming.BlockBuilder.FromDocument(Microsoft.CodeAnalysis.Document)">FromDocument</a></span> <span class="punctuation">(</span><span data-toggle="tooltip" title="Microsoft.CodeAnalysis.Document">document</span><span class="punctuation">)</span><span class="punctuation" data-toggle="tooltip" title="LiterateProgramming.Weaver.BlockListFromDocument(Microsoft.CodeAnalysis.Document)">;</span>
	<span class="punctuation">}</span>
<span class="punctuation">}</span>
</code></pre>

				</div>
				<ul class="pager">
	<li class="previous"><a href="../src/SplitPath.html">Previous: SplitPath Structure</a></li>
	<li class="next"><a href="../src/MdWeaver.html">Next: Markdown Weaver</a></li>
</ul>
			</div>
        </div>
    </div>
    
    <footer class="panel-footer text-center">
        <div align="center">Copyright © 2017 Tommi Johtela</div>
		<div align="right">
			<small>
				Documentation created with <a href="https://johtela.github.io/LiterateProgramming/">Literate Programming</a>.
			</small>
		</div>
    </footer>


    
    <script src="../bootstrap/js/jquery.min.js"></script>
    <script src="../bootstrap/js/bootstrap.min.js"></script>
    <script src="../sidebar/sidebar.js"></script>
    <script src="../syntax-highlight/syntax.js"></script>
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
        extensions: ["jsMath2jax.js"]
        });
    </script>
    <script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS_HTML'></script>
	<script src="../mermaid/mermaid.min.js"></script>
	<script>mermaid.initialize({startOnLoad:true});</script>
</body>
</html>